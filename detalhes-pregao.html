<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Detalhes do Pregão</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script>
    const usuarioLogado = {
      nome: "AdminTech",
      tipo: "fornecedor"
    };

    const pregoes = {
      "001": {
        descricao: "Compra de Servidores",
        tipo: "Compra de material",
        area: "Informática",
        preco: "R$ 25.000,00",
        prazo: "15 dias",
        requisitos: "Entrega em até 15 dias, homologação técnica obrigatória.",
        propostas: 5,
        menor: "R$ 4.750,00",
        maior: "R$ 5.600,00",
        perguntas: 2,
        responsavel: "AdminTech",
        status: "aberto"
      },
      "002": {
        descricao: "Manutenção de Prédio",
        tipo: "Contratação de serviço",
        area: "Construção Civil",
        preco: "R$ 12.000,00",
        prazo: "30 dias",
        requisitos: "Equipe especializada, entrega de cronograma detalhado.",
        propostas: 3,
        menor: "R$ 10.800,00",
        maior: "R$ 11.900,00",
        perguntas: 1,
        responsavel: "Construtora BR",
        status: "aberto"
      },
      "003": {
        descricao: "Sistema de Gestão Escolar",
        tipo: "Compra de software",
        area: "Informática",
        preco: "R$ 40.000,00",
        prazo: "45 dias",
        requisitos: "Interface web, relatórios e integração com bancos de dados.",
        propostas: 4,
        menor: "R$ 37.000,00",
        maior: "R$ 39.500,00",
        perguntas: 2,
        responsavel: "SoftEdu",
        status: "aberto"
      },
      "004": {
        descricao: "Reforma da Biblioteca Central",
        tipo: "Contratação de serviço",
        area: "Obras",
        preco: "R$ 80.000,00",
        prazo: "60 dias",
        requisitos: "Projeto aprovado, cronograma detalhado, ART obrigatória.",
        propostas: 6,
        menor: "R$ 72.000,00",
        maior: "R$ 79.500,00",
        perguntas: 3,
        responsavel: "ObrasLtda",
        status: "fechado",
        vencedor: "Construtora Alpha"
      },
      "005": {
        descricao: "Aquisição de Veículos Administrativos",
        tipo: "Compra de material",
        area: "Transportes",
        preco: "R$ 150.000,00",
        prazo: "90 dias",
        requisitos: "Entrega em até 30 dias, garantia de 2 anos.",
        propostas: 0,
        menor: "-",
        maior: "-",
        perguntas: 0,
        responsavel: "TransportesBR",
        status: "cancelado"
      }
    };

    function carregarDetalhes() {
      const id = new URLSearchParams(window.location.search).get("id");
      const pregao = pregoes[id];
      const container = document.getElementById("conteudoPregao");

      if (!pregao) {
        container.innerHTML = `<div class="alert alert-danger">Pregão não encontrado.</div>`;
        return;
      }

      const isCancelado = pregao.status === "cancelado";
      const isFechado = pregao.status === "fechado";

      container.innerHTML = `
        <h3>${pregao.descricao} (ID: ${id})</h3>
        <strong>Status:</strong> <span class="badge bg-${isCancelado ? 'danger' : isFechado ? 'secondary' : 'success'}">${isCancelado ? 'Cancelado' : isFechado ? 'Fechado' : 'Aberto'}</span>
        <ul class="list-group mt-3 mb-4">
          <li class="list-group-item"><strong>Tipo:</strong> ${pregao.tipo}</li>
          <li class="list-group-item"><strong>Área:</strong> ${pregao.area}</li>
          <li class="list-group-item"><strong>Preço Máximo:</strong> ${pregao.preco}</li>
          <li class="list-group-item"><strong>Prazo:</strong> ${pregao.prazo}</li>
          <li class="list-group-item"><strong>Requisitos:</strong> ${pregao.requisitos}</li>
        </ul>

        <div class="card shadow mb-4">
          <div class="card-header bg-warning text-dark">Estatísticas deste Pregão</div>
          <div class="card-body">
            <ul class="list-group">
              <li class="list-group-item">Propostas recebidas: <strong>${pregao.propostas}</strong></li>
              <li class="list-group-item">Menor valor proposto: <strong>${pregao.menor}</strong></li>
              <li class="list-group-item">Maior valor proposto: <strong>${pregao.maior}</strong></li>
              <li class="list-group-item">Perguntas registradas: <strong>${pregao.perguntas}</strong></li>
              ${isFechado ? `<li class="list-group-item text-success">Vencedor: <strong>${pregao.vencedor}</strong></li>` : ''}
            </ul>
            ${!isCancelado ? `<a href="propostas.html?id=${id}" class="btn btn-outline-dark mt-3">Ver Propostas Recebidas</a>` : ''}
          </div>
        </div>

        ${!isCancelado && !isFechado ? `<a href="proposta.html?id=${id}" class="btn btn-primary mb-4">Fazer Proposta</a>` : isCancelado ? '<div class="alert alert-danger">Este pregão foi cancelado. Não é possível participar.</div>' : ''}
      `;
    }

    window.onload = carregarDetalhes;
  </script>
</head>
<body class="bg-light">
  <header class="bg-info text-white py-3 shadow">
    <div class="container text-center">
      <h1 class="mb-0">
        <a href="index.html" class="text-white text-decoration-none">Sistema de Gestão de Licitações</a>
      </h1>
    </div>
  </header>

  <div class="container mt-5 pt-3">
    <div id="conteudoPregao"></div>
    <a href="pregoes.html" class="btn btn-outline-secondary">Voltar à Lista de Pregões</a>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
